<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<title>GEO åœ¨åº«ãƒã‚§ãƒƒã‚«ãƒ¼ï¼ˆæ‹¡å¼µç‰ˆï¼‰</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        margin: 20px;
        background: #f5f5f5;
    }
    h2 {
        margin-bottom: 10px;
    }
    input, button, select, textarea {
        font-size: 18px;
        padding: 8px;
        width: 100%;
        margin-bottom: 10px;
    }
    button {
        background: #007bff;
        color: white;
        border: none;
        border-radius: 6px;
        padding: 10px;
    }
    button.small {
        width: auto;
        padding: 5px 10px;
        margin-left: 5px;
        font-size: 14px;
    }
    .item-box {
        background: white;
        padding: 10px;
        border-radius: 6px;
        margin-bottom: 10px;
    }
    .stock-yes {
        color: green;
        font-weight: bold;
    }
</style>
</head>

<body>

<h2>ğŸ” ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›</h2>
<input id="pass" type="password" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
<button onclick="login()">ãƒ­ã‚°ã‚¤ãƒ³</button>

<div id="main" style="display:none;">
    <h2>ğŸ“¦ å•†å“ç™»éŒ²ãƒªã‚¹ãƒˆ</h2>
    <input id="addId" placeholder="å•†å“IDï¼ˆä¾‹ï¼š5194150ï¼‰">
    <button onclick="addItem()">è¿½åŠ </button>

    <h3>ç™»éŒ²æ¸ˆã¿å•†å“</h3>
    <div id="itemList"></div>

    <h2>éƒ½é“åºœçœŒ</h2>
    <select id="pref">
        <option value="">å…¨å›½</option>
        <option>åŒ—æµ·é“</option><option>é’æ£®çœŒ</option><option>å²©æ‰‹çœŒ</option><option>å®®åŸçœŒ</option>
        <option>ç§‹ç”°çœŒ</option><option>å±±å½¢çœŒ</option><option>ç¦å³¶çœŒ</option><option>èŒ¨åŸçœŒ</option>
        <option>æ ƒæœ¨çœŒ</option><option>ç¾¤é¦¬çœŒ</option><option>åŸ¼ç‰çœŒ</option><option>åƒè‘‰çœŒ</option>
        <option>æ±äº¬éƒ½</option><option>ç¥å¥ˆå·çœŒ</option><option>æ–°æ½ŸçœŒ</option><option>å¯Œå±±çœŒ</option>
        <option>çŸ³å·çœŒ</option><option>ç¦äº•çœŒ</option><option>å±±æ¢¨çœŒ</option><option>é•·é‡çœŒ</option>
        <option>å²é˜œçœŒ</option><option>é™å²¡çœŒ</option><option>æ„›çŸ¥çœŒ</option><option>ä¸‰é‡çœŒ</option>
        <option>æ»‹è³€çœŒ</option><option>äº¬éƒ½åºœ</option><option>å¤§é˜ªåºœ</option><option>å…µåº«çœŒ</option>
        <option>å¥ˆè‰¯çœŒ</option><option>å’Œæ­Œå±±çœŒ</option><option>é³¥å–çœŒ</option><option>å³¶æ ¹çœŒ</option>
        <option>å²¡å±±çœŒ</option><option>åºƒå³¶çœŒ</option><option>å±±å£çœŒ</option><option>å¾³å³¶çœŒ</option>
        <option>é¦™å·çœŒ</option><option>æ„›åª›çœŒ</option><option>é«˜çŸ¥çœŒ</option><option>ç¦å²¡çœŒ</option>
        <option>ä½è³€çœŒ</option><option>é•·å´çœŒ</option><option>ç†Šæœ¬çœŒ</option><option>å¤§åˆ†çœŒ</option>
        <option>å®®å´çœŒ</option><option>é¹¿å…å³¶çœŒ</option><option>æ²–ç¸„çœŒ</option>
    </select>

    <button onclick="checkAll()">åœ¨åº«ãƒã‚§ãƒƒã‚¯ï¼ˆç™»éŒ²å•†å“ã¾ã¨ã‚ã¦ï¼‰</button>

    <h2>åœ¨åº«çµæœï¼ˆåœ¨åº«ã‚ã‚Šã®ã¿ï¼‰</h2>
    <div id="result"></div>
</div>

<script>
// ------------------------
// ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼
// ------------------------
function login() {
    if (document.getElementById("pass").value === "1") {
        document.getElementById("main").style.display = "block";
    } else {
        alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™");
    }
}

// ------------------------
// å•†å“ãƒªã‚¹ãƒˆä¿å­˜
// ------------------------
function loadList() {
    const list = JSON.parse(localStorage.getItem("items") || "[]");
    displayList(list);
}
function saveList(list) {
    localStorage.setItem("items", JSON.stringify(list));
}
function addItem() {
    let id = document.getElementById("addId").value.trim();
    if (!id) return alert("å•†å“IDã‚’å…¥åŠ›ã—ã¦ä¸‹ã•ã„");
    let list = JSON.parse(localStorage.getItem("items") || "[]");
    list.push({ id });
    saveList(list);
    displayList(list);
    document.getElementById("addId").value = "";
}

// ------------------------
// å•†å“ãƒªã‚¹ãƒˆè¡¨ç¤º & ä¸¦ã³æ›¿ãˆ
// ------------------------
function displayList(list) {
    const box = document.getElementById("itemList");
    box.innerHTML = "";
    list.forEach((item, i) => {
        let div = document.createElement("div");
        div.className = "item-box";
        div.innerHTML = `
            <b>ID: ${item.id}</b>
            <button class="small" onclick="delItem(${i})">å‰Šé™¤</button>
            <button class="small" onclick="moveUp(${i})">â†‘</button>
            <button class="small" onclick="moveDown(${i})">â†“</button>
        `;
        box.appendChild(div);
    });
}
function delItem(i) {
    let list = JSON.parse(localStorage.getItem("items") || "[]");
    list.splice(i, 1);
    saveList(list);
    displayList(list);
}
function moveUp(i) {
    let list = JSON.parse(localStorage.getItem("items") || "[]");
    if (i === 0) return;
    [list[i], list[i - 1]] = [list[i - 1], list[i]];
    saveList(list);
    displayList(list);
}
function moveDown(i) {
    let list = JSON.parse(localStorage.getItem("items") || "[]");
    if (i === list.length - 1) return;
    [list[i], list[i + 1]] = [list[i + 1], list[i]];
    saveList(list);
    displayList(list);
}

// ------------------------
// å•†å“åã®è‡ªå‹•å–å¾—
// ------------------------
async function getItemName(id) {
    try {
        let url = `https://geo-online.co.jp/store_info/item/${id}/`;
        let html = await (await fetch(url)).text();
        let title = html.match(/<title>(.*?)<\/title>/);
        if (!title) return "å•†å“åä¸æ˜";
        return title[1].replace("ï½œã‚²ã‚ªã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ãƒˆã‚¢", "").trim();
    } catch {
        return "å•†å“åä¸æ˜";
    }
}

// ------------------------
// åœ¨åº«ãƒã‚§ãƒƒã‚¯
// ------------------------
async function checkAll() {
    let pref = document.getElementById("pref").value;
    let list = JSON.parse(localStorage.getItem("items") || "[]");

    let resultBox = document.getElementById("result");
    resultBox.innerHTML = "æ¤œç´¢ä¸­â€¦";

    let out = "";

    for (let item of list) {
        let name = await getItemName(item.id);
        let url = `https://geo-online.co.jp/store_info/item/${item.id}/`;

        try {
            let html = await (await fetch(url)).text();

            // åœ¨åº«ã‚ã‚Šåˆ¤å®šï¼ˆGEOã¯ã€Œåœ¨åº«ã‚ã‚Šã€è¡¨è¨˜ãŒã‚ã‚‹ï¼‰
            let stock = html.includes("åœ¨åº«ã‚ã‚Š");

            if (stock) {
                out += `
                <div class="item-box">
                    <span class="stock-yes">â— åœ¨åº«ã‚ã‚Š</span><br>
                    <b>${name}</b><br>
                    å•†å“ID: ${item.id}<br>
                    <a href="${url}" target="_blank">å•†å“ãƒšãƒ¼ã‚¸</a>
                </div>`;
            }
        } catch {
            out += `<div class="item-box">å–å¾—ã‚¨ãƒ©ãƒ¼ï¼ˆID: ${item.id}ï¼‰</div>`;
        }
    }

    resultBox.innerHTML = out || "åœ¨åº«ã‚ã‚Šã®å•†å“ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚";
}

// åˆæœŸãƒ­ãƒ¼ãƒ‰
loadList();
</script>

</body>
</html>
